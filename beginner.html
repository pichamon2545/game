<!DOCTYPE html>
<html>
  <head>
    <title>The Timing Game</title>
    <script src="jspsych/jspsych.js"></script>
    <script src="jspsych/plugin-html-keyboard-response.js"></script>
    <script src="jspsych/plugin-image-keyboard-response.js"></script>
    <script src="jspsych/plugin-audio-keyboard-response.js"></script>
    <script src="jspsych/plugin-preload.js"></script>
    <link rel="stylesheet" href="jspsych/jspsych.css">
  </head>
  <body></body>
  <script type="module">
    import uniform from 'https://cdn.jsdelivr.net/gh/stdlib-js/random-base-uniform@esm/index.mjs';
    function blackscreen() {
        document.body.style.backgroundColor = 'black'
    }
    function whitescreen() {
        document.body.style.backgroundColor = 'white'
    }

    /* initialize jsPsych */
    var jsPsych = initJsPsych({
      on_finish: function () {
        jsPsych.data.displayData();
      },
      override_safe_mode: true
    });

    /* create timeline */
    var timeline = [];

    /* welcome message */
    var welcome = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: `<h1>Welcome to the experiment</h1>
      <p>The experiment will start in 3 seconds.</p>`,
      choices: "NO_KEYS",
      trial_duration: 2000
    };
    timeline.push(welcome);

    /* begin trials */
    var fixation = {
      type: jsPsychHtmlKeyboardResponse,
      on_start: blackscreen,
      stimulus: '',
      choices: "NO_KEYS",
      trial_duration: function(){
        return uniform(400, 1500);
      }
    };

    var test = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<div style="font-size:80px; color:red">START</div>',
      on_start: whitescreen,
      data: {
        task: 'response'
      },
      on_finish: function (data) {
        data.correct = data.rt > 2300 && data.rt < 4300;
        data.response_time = data.rt
      }
    };

    /* define test procedure */
    var test_procedure = {
      timeline: [fixation, test],
      randomize_order: true
    };
    timeline.push(test_procedure);


    /* start the experiment */
    jsPsych.run(timeline);
  
  </script>
</html>